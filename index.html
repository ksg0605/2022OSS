<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>모범식당에서 밥먹으라게~</title>
    
</head>
<body>
<h2 align = "center">모범식당에서 밥먹으라게~</h2>
<div id="map" align = "center" style="width:1000px;height:500px;"></div>
<table border="1" align = "center">
    <th align = "center" bgcolor="Crimson">한식</th>
	<th align = "center" bgcolor="Orange">일식</th>
    <th align = "center" bgcolor="Khaki">중식</th>
	<th align = "center" bgcolor="LightPink">고기</th>
    <th align = "center" bgcolor="SeaGreen">회</th>
	<th align = "center" bgcolor="DimGray">기타</th>
 </table>
 <h5 align = "center">2022 오픈소스개발방법론</h5>
 <h6 align = "center">NAITE 팀 - 김벼리, 김다현, 양현주</h6>
<script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=686fb8e1d013ab9cd70720ab4622dbe0&libraries=services"></script>
<script>

    const url = "https://api.odcloud.kr/api/15055981/v1/uddi:6d218756-7258-42b6-9ab6-d3f07effeb0d?page=1&perPage=240&serviceKey=VfxwJOiRK4Lubg%2BzpSfUrSZpPCdgWPxRzvzRQyBH76dJsrXQ8xmYY1xae3ObsrVrmsWNO7twRmauyRcM0yqY%2Fg%3D%3D";
      fetch(url)
      .then((res) => res.json())
      .then((myJson) => {
        //document.getElementById("data").innerText = JSON.stringify(myJson, null, 1);
	//	console.log(Object.keys(myJson));
		var obj_key = Object.keys(myJson);
		var obj_value = myJson['data'];
	//	console.log(Object.keys(obj_value[0]));
	//	console.log(obj_value[0].메뉴); // 횟집
	//	console.log(Object.values(obj_value[0]));
		
		var count_h = 0, count_j = 0, count_c = 0, count_m = 0, count_f = 0, count_g = 0;
		var h_name = []; //한식 가격명
		var h_location = []; // 한식 소재지
		var j_name = []; // 일식 가격명
		var j_location = []; // 일식 소재지
		var c_name = [];
		var c_location = [];
		var m_name = [];
		var m_location = [];
		var f_name = [];
		var f_location = [];
		var g_name = [];
		var g_location = [];

		for (var i = 0; i < obj_value.length; i++)
		{
			if (obj_value[i].메뉴 == "한식") {
				h_name[count_h] = obj_value[i].업소명;
				h_location[count_h] = obj_value[i].소재지;
				count_h++;
			}
			else if (obj_value[i].메뉴 == "일식") {
				j_name[count_j] = obj_value[i].업소명;
				j_location[count_j] = obj_value[i].소재지;
				count_j++;
			}
			else if (obj_value[i].메뉴 == "중국식") {
				c_name[count_c] = obj_value[i].업소명;
				c_location[count_c] = obj_value[i].소재지;
				count_c++;
			}
			else if (obj_value[i].메뉴 == "식육(숯불구이)") {
				m_name[count_m] = obj_value[i].업소명;
				m_location[count_m] = obj_value[i].소재지;
				count_m++;
			}
			else if (obj_value[i].메뉴 == "횟집") {
				f_name[count_f] = obj_value[i].업소명;
				f_location[count_f] = obj_value[i].소재지;
				count_f++;
			}
			else {
				g_name[count_g] = obj_value[i].업소명;
				g_location[count_g] = obj_value[i].소재지;
				count_g++;
			}
		}
		

		var mapContainer = document.getElementById('map'), // 지도를 표시할 div 
    mapOption = {
        center: new daum.maps.LatLng(33.450701, 126.570667), // 지도의 중심좌표
        level: 3 // 지도의 확대 레벨
    };  

    // 지도를 생성합니다    
    var map = new daum.maps.Map(mapContainer, mapOption); 

	if (navigator.geolocation) {
    
    // GeoLocation을 이용해서 접속 위치를 얻어옵니다
    navigator.geolocation.getCurrentPosition(function(position) {
        
        var lat = position.coords.latitude, // 위도
            lon = position.coords.longitude; // 경도
        
        var locPosition = new kakao.maps.LatLng(lat, lon), // 마커가 표시될 위치를 geolocation으로 얻어온 좌표로 생성합니다
            message = '<div style="padding:5px;">현위치!</div>'; // 인포윈도우에 표시될 내용입니다
        
        // 마커와 인포윈도우를 표시합니다
        displayMarker(locPosition, message);
            
      });
    
} else { // HTML5의 GeoLocation을 사용할 수 없을때 마커 표시 위치와 인포윈도우 내용을 설정합니다
    
    var locPosition = new kakao.maps.LatLng(33.450701, 126.570667),    
        message = '위치를 찾을 수 없습니다'
        
    displayMarker(locPosition, message);
}

// 지도에 마커와 인포윈도우를 표시하는 함수입니다
function displayMarker(locPosition, message) {

    // 마커를 생성합니다
    var marker = new kakao.maps.Marker({  
        map: map, 
        position: locPosition
    }); 
    
    var iwContent = message, // 인포윈도우에 표시할 내용
        iwRemoveable = true;

    // 인포윈도우를 생성합니다
    var infowindow = new kakao.maps.InfoWindow({
        content : iwContent,
        removable : iwRemoveable
    });
    
    // 인포윈도우를 마커위에 표시합니다 
    infowindow.open(map, marker);
    
    // 지도 중심좌표를 접속위치로 변경합니다
    map.setCenter(locPosition);      
}    


    // 주소-좌표 변환 객체를 생성합니다
    var geocoder = new daum.maps.services.Geocoder();

	var K_imageSrc = "red.png"; 
	var J_imageSrc = "orange.png"; 
	var C_imageSrc = "yellow.png"; 
	var M_imageSrc = "pink.png"; 
	var F_imageSrc = "green.png"; 
	var G_imageSrc = "black.png"; 
    
	// 한식
    for (var i=0; i < h_name.length ; i++) {
		var imageSize = new kakao.maps.Size(24, 35); 
		 var markerImage1 = new kakao.maps.MarkerImage(K_imageSrc, imageSize); 

        // 주소로 좌표를 검색합니다
        geocoder.addressSearch(h_location[i], function(result, status) {

        // 정상적으로 검색이 완료됐으면 
         if (status === daum.maps.services.Status.OK) {

            var coords = new daum.maps.LatLng(result[0].y, result[0].x);

        // 결과값으로 받은 위치를 마커로 표시합니다
        var marker = new daum.maps.Marker({
            map: map,
            position: coords,
			image : markerImage1
        });


    } 
})};
	// 일식
	for (var i=0; i < j_name.length ; i++) {
		
		var imageSize = new kakao.maps.Size(24, 35); 
		var markerImage2 = new kakao.maps.MarkerImage(J_imageSrc, imageSize); 

        // 주소로 좌표를 검색합니다
        geocoder.addressSearch(j_location[i], function(result, status) {

        // 정상적으로 검색이 완료됐으면 
         if (status === daum.maps.services.Status.OK) {

            var coords = new daum.maps.LatLng(result[0].y, result[0].x);

        // 결과값으로 받은 위치를 마커로 표시합니다
        var marker = new daum.maps.Marker({
            map: map,
            position: coords,
			image : markerImage2
        });


    } 
})};
	
	// 중식
	for (var i=0; i < c_name.length ; i++) {
		var imageSize = new kakao.maps.Size(24, 35); 
		var markerImage3 = new kakao.maps.MarkerImage(C_imageSrc, imageSize); 

        // 주소로 좌표를 검색합니다
        geocoder.addressSearch(c_location[i], function(result, status) {

        // 정상적으로 검색이 완료됐으면 
         if (status === daum.maps.services.Status.OK) {

            var coords = new daum.maps.LatLng(result[0].y, result[0].x);

        // 결과값으로 받은 위치를 마커로 표시합니다
        var marker = new daum.maps.Marker({
            map: map,
            position: coords,
			image : markerImage3
        });


    } 
})};
	
	// 고기
	for (var i=0; i < m_name.length ; i++) {
		var imageSize = new kakao.maps.Size(24, 35); 
		var markerImage4 = new kakao.maps.MarkerImage(M_imageSrc, imageSize); 

        // 주소로 좌표를 검색합니다
        geocoder.addressSearch(m_location[i], function(result, status) {

        // 정상적으로 검색이 완료됐으면 
         if (status === daum.maps.services.Status.OK) {

            var coords = new daum.maps.LatLng(result[0].y, result[0].x);

        // 결과값으로 받은 위치를 마커로 표시합니다
        var marker = new daum.maps.Marker({
            map: map,
            position: coords,
			image : markerImage4
        });

    } 
})};
	// 횟집
	for (var i=0; i < f_name.length ; i++) {
		var imageSize = new kakao.maps.Size(24, 35); 
		var markerImage5 = new kakao.maps.MarkerImage(F_imageSrc, imageSize); 

        // 주소로 좌표를 검색합니다
        geocoder.addressSearch(f_location[i], function(result, status) {

        // 정상적으로 검색이 완료됐으면 
         if (status === daum.maps.services.Status.OK) {

            var coords = new daum.maps.LatLng(result[0].y, result[0].x);

        // 결과값으로 받은 위치를 마커로 표시합니다
        var marker = new daum.maps.Marker({
            map: map,
            position: coords,
			image : markerImage5
        });


    } 
})};

	//기타
	for (var i=0; i < g_name.length ; i++) {
		var imageSize = new kakao.maps.Size(24, 35); 
		var markerImage6 = new kakao.maps.MarkerImage(G_imageSrc, imageSize); 

        // 주소로 좌표를 검색합니다
        geocoder.addressSearch(g_location[i], function(result, status) {

        // 정상적으로 검색이 완료됐으면 
         if (status === daum.maps.services.Status.OK) {

            var coords = new daum.maps.LatLng(result[0].y, result[0].x);

        // 결과값으로 받은 위치를 마커로 표시합니다
        var marker = new daum.maps.Marker({
            map: map,
            position: coords,
			image : markerImage6
        });


        
    } 
})};

      });

       


 
</script>

</body>
</html>
